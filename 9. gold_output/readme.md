# Исследование технологического процесса очистки золота

### Сферы деятельности:
- промышленность

### Направление деятельности:
- машинное обучение
- аналитик

### Навыки и инструменты:
- python
- pandas, matplotlib, numpy, scikit-learn
- исследовательский анализ

## Описание проекта

Строится модель машинного обучения для промышленной компании, разрабатывающая решения для эффективной работы промышленных предприятий. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды на основе данных с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Цель исследования

Спрогнозировать концентрацию золота при проведении процесса очистки золота 

## Ход исследования

Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.
Вам нужно:
- Подготовить данные;
- Провести исследовательский анализ данных;
- Построить и обучить модель.

## Описание данных

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.
В вашем распоряжении сырые данные: их просто выгрузили из хранилища. Прежде чем приступить к построению модели, проверьте по нашей инструкции их на корректность.

## Вывод по итогам исследования

В ходе работы были проанализированы и подготовлены начальные данные 

Также, по заданию, мы убедились что **rougher.output.recovery** посчитан правильно: MAE очень близок к 0.

Из обучающей выборки были удалены все столбцы - признаки (кроме целевых), которые отсутсвуют в тестовой выборке, так как мы должны обучать модель по тем данным, которые у нас будут участвовать в тесте.

Пропуски были заполнены с помощью интерполяции.

В ходе **анализа** было установлено:

**Для золота**

- Отчетливо видно, что концентрация золота увеличивается с последующим этапом очистки. Оно и логично - технологический процесс очистки золотой руды подразумевает увеличение концентрации продукта

**Для серебра** 

- После флотации концентрация серебра максимальна, но в последующих процессах она снижается и достигает своего минимума 

**Для свинца**

- Концентрация свинца увеличивается в ходе технологического процесса. После первичной очистки концентрация свинца в руде достигает максимума

Размеры гранул в тренировочной и тестовой выборках отличаются незначительно, и с определенной погрешностью мы считает, что имеющиеся различия данных критически не повлияют на результаты моделей

Суммарная концентрация веществ с достаточно большой погрешностью можно сказать, что располагается в одном плотном диапазоне 40 - 80 % на каждом этапе технологическом процесса.

При этом, если рассматривать только суммарные концентрации металлов (без примесей), то мы видим, что их концентрация растет.

Касательно выбросов, которые наблюдаются в около 0 значениях. Формально - это выбросы. Однако, наша цель создать модель, которая будет обучаться только по концентрациям исходного сырья (см. пункт 1.3). Поэтому полезно будет отсеять околонулевые значения только этого столбца, чтобы по индексам (**date**) исключатся некорректные данные в обучающей выборке и тестовой выборке

При создании моделей:

Была составлены функции **sMAPE** и **final_sMAPE** - целевой признак, по которому определялась насколько эффективна модель регрессии относительно других. 

Среди трех моделей (линейной, дерева и случайного леса) с помощью кросс-валидации было показано, что наилучшие результаты показала модель случайного леса (**11,96 %**).

После подбора гиперпараметров результат final_sMAPE на тренировочной выборке удалось улучшить до **10,41 %**

Реузльтат sMAPE на тестовой выборке показал **9,8 %** 

Также была сделана проверка адекватности с помощью Dummy модели, результат которой получился **10,29 %**